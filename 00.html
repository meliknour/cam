<!-- settings.html -->
<form id="settingsForm">
  <input type="text" id="firstName" placeholder="Ø§Ù„Ø§Ø³Ù…">
  <input type="text" id="lastName" placeholder="Ø§Ù„Ù„Ù‚Ø¨">
  <label>
    <input type="checkbox" id="darkMode"> ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ
  </label>
  <button type="submit">Ø­ÙØ¸</button>
</form>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.11/firebase-app.js";
  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.6.11/firebase-auth.js";
  import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/9.6.11/firebase-firestore.js";

  // ğŸ”¹ Ø¶Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø´Ø±ÙˆØ¹Ùƒ Ù‡Ù†Ø§
  const firebaseConfig = {
        const firebaseConfig = {
            apiKey: "AIzaSyBq45NTkOCdirrGjwPqv_kUJ7tibyThJww",
            authDomain: "soft-ff1e8.firebaseapp.com",
            projectId: "soft-ff1e8",
            storageBucket: "soft-ff1e8.appspot.com",
            messagingSenderId: "17443109810",
            appId: "1:17443109810:web:c72598153a7b82ba3042ab",
            measurementId: "G-NR4LP6M583"
        };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  const form = document.getElementById("settingsForm");

  onAuthStateChanged(auth, async (user) => {
    if (!user) {
      window.location.href = "login.html";
      return;
    }

    const userRef = doc(db, "users", user.uid);
    const snap = await getDoc(userRef);

    if (snap.exists()) {
      document.getElementById("firstName").value = snap.data().firstName || "";
      document.getElementById("lastName").value = snap.data().lastName || "";
      document.getElementById("darkMode").checked = snap.data().darkMode || false;
    }

    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      await setDoc(userRef, {
        firstName: document.getElementById("firstName").value,
        lastName: document.getElementById("lastName").value,
        darkMode: document.getElementById("darkMode").checked
      }, { merge: true });

      alert("âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ù†Ø¬Ø§Ø­");
    });
  });
</script>

