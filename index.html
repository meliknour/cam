<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>تسجيل الدخول / إنشاء حساب</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root { --bg:#f0f2f5; --card:#fff; --primary:#3a3b57; --text:#111; --error:#d93025; --success:#188038; --transition:all 0.3s ease; }
    body.dark { --bg:#18191a; --card:#242526; --primary:#9aa0a6; --text:#e4e6eb; }
    body { font-family:'Segoe UI',Tahoma,Arial,sans-serif; background:var(--bg); margin:0; display:flex; justify-content:center; align-items:center; min-height:100vh; transition:var(--transition); padding:20px; }
    .card { background:var(--card); padding:25px; border-radius:12px; box-shadow:0 4px 15px rgba(0,0,0,0.1); width:100%; max-width:420px; min-height:400px; transition:var(--transition); position:relative; display:flex; flex-direction:column; }
    body.dark .card { box-shadow:0 4px 15px rgba(0,0,0,0.3); }
    h2 { margin:0 0 20px; color:var(--primary); text-align:center; transition:var(--transition); }
    .form-container { position:relative; flex:1; min-height:380px; }
    .form { position:absolute; width:100%; transition:all 0.4s cubic-bezier(0.68,-0.55,0.27,1.55); }
    #loginForm { left:0; opacity:1; transform:translateX(0); }
    #registerForm { left:0; opacity:0; transform:translateX(100%); }
    .show-register #loginForm { opacity:0; transform:translateX(-100%); }
    .show-register #registerForm { opacity:1; transform:translateX(0); }
    .input-group { margin-bottom:18px; position:relative; }
    input { width:90%; padding:12px 40px 12px 12px; border:1px solid #ccc; border-radius:8px; background:transparent; color:var(--text); font-size:15px; transition:var(--transition); }
    body.dark input { border-color:#4e4f50; }
    input:focus { outline:none; border-color:var(--primary); box-shadow:0 0 0 2px rgba(58,59,87,0.2); }
    .toggle-password { position:absolute; left:12px; top:50%; transform:translateY(-50%); cursor:pointer; font-size:16px; color:#777; background:none; border:none; width:24px; height:24px; display:flex; align-items:center; justify-content:center; }
    body.dark .toggle-password { color:#b0b3b8; }
    button.submit-btn { width:100%; padding:12px; border:none; border-radius:8px; background:var(--primary); color:#fff; font-weight:bold; cursor:pointer; transition:var(--transition); margin-top:5px; }
    button.submit-btn:hover { opacity:0.9; transform:translateY(-2px); }
    .switch { margin-top:15px; text-align:center; font-size:14px; color:#65676b; }
    .switch span { color:var(--primary); cursor:pointer; font-weight:600; transition:var(--transition); }
    .switch span:hover { text-decoration:underline; }
    .toggle-mode { text-align:center; margin-top:20px; font-size:14px; cursor:pointer; color:var(--primary); display:flex; align-items:center; justify-content:center; gap:8px; transition:var(--transition); }
    .toggle-mode:hover { opacity:0.8; }
    .forgot { text-align:left; font-size:13px; margin-top:-10px; margin-bottom:15px; }
    .forgot span { color:var(--primary); cursor:pointer; transition:var(--transition); }
    .forgot span:hover { text-decoration:underline; }
    .password-rules { font-size:12px; margin-top:-5px; margin-bottom:15px; line-height:1.6; max-height:0; overflow:hidden; transition:max-height 0.3s ease; }
    .password-rules.show { max-height:100px; }
    .rule { display:flex; align-items:center; gap:6px; margin-bottom:4px; }
    .rule i { font-size:10px; transition:var(--transition); }
    .rule.valid { color:var(--success); }
    .rule.invalid { color:var(--error); }
    .message { padding:10px; border-radius:6px; margin-bottom:15px; text-align:center; display:none; font-size:14px; transition:var(--transition); }
    .error { background-color: rgba(217,48,37,0.1); color:var(--error); border:1px solid rgba(217,48,37,0.2); }
    .success { background-color: rgba(24,128,56,0.1); color:var(--success); border:1px solid rgba(24,128,56,0.2); }
    @keyframes fadeIn { from { opacity:0; transform:translateY(-10px); } to { opacity:1; transform:translateY(0); } }
    .fade-in { animation:fadeIn 0.5s ease forwards; }
  </style>
</head>
<body>
  <div class="card">
    <div class="form-container" id="formContainer">
      <!-- Login Form -->
      <div class="form" id="loginForm">
        <h2>تسجيل الدخول</h2>
        <div class="message error" id="loginMessage"></div>
        <div class="input-group">
          <input type="email" id="loginEmail" placeholder="البريد الإلكتروني" required>
        </div>
        <div class="input-group">
          <input type="password" id="loginPassword" placeholder="كلمة المرور" required>
          <button type="button" class="toggle-password" onclick="togglePassword('loginPassword', this)">
            <i class="far fa-eye"></i>
          </button>
        </div>
        <div class="forgot"><span onclick="resetPassword()">نسيت كلمة المرور؟</span></div>
        <button class="submit-btn" onclick="login()">تسجيل الدخول</button>
        <div class="switch">ليس لديك حساب؟ <span onclick="showRegister()">إنشاء حساب</span></div>
      </div>

      <!-- Register Form -->
      <div class="form" id="registerForm">
        <h2>إنشاء حساب</h2>
        <div class="message error" id="registerMessage"></div>
        <div class="input-group">
          <input type="text" id="registerName" placeholder="الاسم الكامل" required>
        </div>
        <div class="input-group">
          <input type="email" id="registerEmail" placeholder="البريد الإلكتروني" required>
        </div>
        <div class="input-group">
          <input type="password" id="registerPassword" placeholder="كلمة المرور" required oninput="checkPassword(this.value)">
          <button type="button" class="toggle-password" onclick="togglePassword('registerPassword', this)">
            <i class="far fa-eye"></i>
          </button>
        </div>
        <div id="passwordRules" class="password-rules">
          <div class="rule invalid" id="lengthRule"><i class="fas fa-circle"></i> 8 أحرف على الأقل</div>
          <div class="rule invalid" id="upperRule"><i class="fas fa-circle"></i> حرف كبير واحد على الأقل</div>
          <div class="rule invalid" id="numberRule"><i class="fas fa-circle"></i> رقم واحد على الأقل</div>
        </div>
        <button class="submit-btn" onclick="register()" id="registerBtn">إنشاء حساب</button>
        <div class="switch">لديك حساب بالفعل؟ <span onclick="showLogin()">تسجيل الدخول</span></div>
      </div>
    </div>

    <div class="toggle-mode" onclick="toggleMode()">
      <i class="fas fa-moon"></i> تبديل الوضع الليلي
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js";
    import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, sendPasswordResetEmail, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-auth.js";
    import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js";

    const firebaseConfig = {
      apiKey:"AIzaSy
