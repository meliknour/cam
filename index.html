<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>ุงูุจุญุซ ูู Google Sheets</title>
</head>
<body>
  <div id="result">ุฌุงุฑู ุงูุชุญููู...</div>

  <script>
    // ุฑุงุจุท Google Sheets ุจุตูุบุฉ CSV (ุบูุฑู ุจุฑุงุจุทู)
    const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-XXXXXX/pub?gid=0&single=true&output=csv";

    // ูุงุฎุฐ ุงูููุฏ ูู ุงูุฑุงุจุท ุจุนุฏ ุนูุงูุฉ ?
    const query = decodeURIComponent(window.location.search.substring(1)).trim();

    // ููุงู ุนุฑุถ ุงููุชูุฌุฉ
    const resultDiv = document.getElementById("result");

    if (query) {
      fetch(sheetUrl)
        .then(res => res.text())
        .then(csv => {
          const rows = csv.split("\n").map(r => r.split(","));
          let found = false;

          rows.forEach(row => {
            // ููุธู ุงููููุฉ ูู ุฃู ูุณุงูุงุช ุฃู ุฑููุฒ ุบูุฑ ูุฑุฆูุฉ
            const cell = row[0] ? row[0].trim().replace(/\u200B/g, "") : "";

            if (cell === query) {
              resultDiv.textContent = "โ ุชู ุงูุนุซูุฑ: " + row.join(" | ");
              found = true;
            }
          });

          if (!found) {
            resultDiv.textContent = "โ ูู ูุชู ุงูุนุซูุฑ ุนูู " + query;
          }
        })
        .catch(err => {
          resultDiv.textContent = "๐จ ุชุนุฐุฑ ุชุญููู ุงูุจูุงูุงุช ูู Google Sheets";
        });
    } else {
      resultDiv.textContent = "โน๏ธ ูู ูุชู ุฅุฏุฎุงู ุฃู ููุฏ ูู ุงูุฑุงุจุท";
    }
  </script>
</body>
</html>
